{"ast":null,"code":"var _jsxFileName = \"D:\\\\project\\\\dubai\\\\uiho\\\\src\\\\components\\\\reserve\\\\Reserve.jsx\",\n    _s = $RefreshSig$();\n\nimport \"./reserve.css\";\nimport { faCircleXmark } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport useFetch from \"../../hooks/useFetch\";\nimport { useState } from \"react\";\nimport { useContext } from \"react\";\nimport { SearchContext } from \"../../context/searchContext\";\nimport { useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Reserve = _ref => {\n  _s();\n\n  let {\n    setOpen,\n    hotelId\n  } = _ref;\n  const [selectedRooms, setselectedRooms] = useState([]);\n  const {\n    data,\n    loading,\n    error\n  } = useFetch(`/hotels/room/${hotelId}`);\n  const {\n    date\n  } = useContext(SearchContext);\n\n  const getDatesInRange = (startDate, endDate) => {\n    const start = new Date(startDate);\n    const end = new Date(endDate);\n    const date = new Date(start.getTime());\n    const dates = [];\n\n    while (date <= end) {\n      dates.push(new Date(date).getTime());\n      date.setDate(date.getDate() + 1);\n    }\n\n    return dates;\n  };\n\n  const alldates = getDatesInRange(date[0].startDate, date[0].endDate);\n\n  const isAvailable = roomnumber => {\n    const isFound = roomnumber.unavalailableDates.some(date => alldates.includes(new Date(date).getTime()));\n    return !isFound;\n  };\n\n  const handleSelect = e => {\n    const checked = e.target.checked;\n    const value = e.target.value;\n    setselectedRooms(checked ? [...selectedRooms, value] : selectedRooms.filter(item => item !== value));\n  };\n\n  const navigate = useNavigate();\n\n  const handleClick = async () => {\n    try {\n      await Promise.all(selectedRooms.map(roomId => {\n        const res = axios.put(`/room/availability/${roomId}`, {\n          date: alldates\n        });\n        return res.data;\n      }));\n      setOpen(false);\n      navigate(\"/\");\n    } catch (err) {}\n  };\n\n  console.log(selectedRooms);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"reserve\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"reservecontainer\",\n      children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n        icon: faCircleXmark,\n        className: \"rclose\",\n        onClick: () => setOpen(false)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"select your rooms:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, this), data.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ritem\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"riteminfo\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rtittle\",\n            children: item.tittle\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rdesc\",\n            children: item.desc\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rmax\",\n            children: [\" Max people : \", /*#__PURE__*/_jsxDEV(\"b\", {\n              children: item.maxPeople\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 78,\n              columnNumber: 51\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rprice\",\n          children: item.price\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rselectrooms\",\n          children: item.roomnumbers.map(roomnumber => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"room\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: roomnumber.number\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 84,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              value: roomnumber._id,\n              onChange: handleSelect,\n              disabled: !isAvailable(roomnumber)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 14\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleClick,\n        className: \"rbtn\",\n        children: \"reserve now!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Reserve, \"PaXUjDfrO/Gvu7RvqW9ooYZe30A=\", false, function () {\n  return [useFetch, useNavigate];\n});\n\n_c = Reserve;\nexport default Reserve;\n\nvar _c;\n\n$RefreshReg$(_c, \"Reserve\");","map":{"version":3,"sources":["D:/project/dubai/uiho/src/components/reserve/Reserve.jsx"],"names":["faCircleXmark","FontAwesomeIcon","useFetch","useState","useContext","SearchContext","useNavigate","axios","Reserve","setOpen","hotelId","selectedRooms","setselectedRooms","data","loading","error","date","getDatesInRange","startDate","endDate","start","Date","end","getTime","dates","push","setDate","getDate","alldates","isAvailable","roomnumber","isFound","unavalailableDates","some","includes","handleSelect","e","checked","target","value","filter","item","navigate","handleClick","Promise","all","map","roomId","res","put","err","console","log","tittle","desc","maxPeople","price","roomnumbers","number","_id"],"mappings":"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","sourcesContent":["import \"./reserve.css\"\r\nimport {faCircleXmark} from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport useFetch from \"../../hooks/useFetch\"\r\nimport { useState } from \"react\";\r\nimport { useContext } from \"react\";\r\nimport { SearchContext } from \"../../context/searchContext\";\r\nimport {  useNavigate } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\n\r\n\r\n\r\n\r\nconst Reserve = ({setOpen,hotelId}) => {\r\n  const [selectedRooms,setselectedRooms] = useState([])\r\n  const {data,loading,error}  = useFetch(`/hotels/room/${hotelId}`);\r\n  const {date} = useContext(SearchContext);\r\n\r\n  const getDatesInRange = (startDate,endDate) => {\r\n\r\n    const start = new Date(startDate);\r\n    const end = new Date(endDate);\r\n    const date = new Date(start.getTime());\r\n    const dates = [];\r\n\r\n    while (date <= end){\r\n      dates.push(new Date(date).getTime());\r\n      date.setDate(date.getDate()+1);\r\n    }\r\n     return dates;\r\n  };\r\n const alldates = getDatesInRange(date[0].startDate,date[0].endDate);\r\n\r\n const isAvailable = (roomnumber) =>{\r\n  const isFound = roomnumber.unavalailableDates.some((date) =>\r\n  alldates.includes(new Date(date).getTime())\r\n  );\r\n  return !isFound\r\n }\r\n\r\n  const handleSelect = (e) =>{\r\n    const checked = e.target.checked;\r\n    const value = e.target.value;\r\n    setselectedRooms(\r\n      checked ? [...selectedRooms,value] : selectedRooms.filter((item)=> item !== value)\r\n    );\r\n  };\r\n\r\n  const navigate = useNavigate();\r\n\r\n  const handleClick = async () =>{\r\n    try{\r\n      await  Promise.all(selectedRooms.map((roomId)=>{\r\n        const res = axios.put(`/room/availability/${roomId}`,{date: alldates,});\r\n        return res.data;\r\n      }));\r\n      setOpen(false);\r\n      navigate(\"/\");\r\n    }catch(err){\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  console.log(selectedRooms);\r\n  return (\r\n    <div className=\"reserve\">\r\n      <div className=\"reservecontainer\">\r\n      <FontAwesomeIcon icon={faCircleXmark}  className=\"rclose\" onClick={()=>\r\n        setOpen(false)}/>\r\n        <span>select your rooms:</span>\r\n        {data.map(item=>(\r\n          <div className=\"ritem\">\r\n            <div className=\"riteminfo\">\r\n              <div className=\"rtittle\">{item.tittle}</div>\r\n              <div className=\"rdesc\">{item.desc}</div>\r\n              <div className=\"rmax\"> Max people : <b>{item.maxPeople}</b></div>\r\n            </div>\r\n            <div className=\"rprice\">{item.price}</div>\r\n            <div className=\"rselectrooms\">\r\n            {item.roomnumbers.map((roomnumber)=>(\r\n             <div className=\"room\">\r\n              <label>{roomnumber.number}</label>\r\n              <input type=\"checkbox\" value={roomnumber._id} onChange={handleSelect} \r\n               disabled = {!isAvailable(roomnumber)}\r\n               />\r\n             </div>\r\n            ))}\r\n            </div>\r\n        \r\n         \r\n         \r\n          </div>\r\n        ))}\r\n        <button onClick={handleClick} className=\"rbtn\">reserve now!</button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Reserve"]},"metadata":{},"sourceType":"module"}